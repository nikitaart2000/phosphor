{
  "$schema": "../gen/schemas/desktop-schema.json",
  "identifier": "phosphor-default",
  "description": "Capability for the main window",
  "windows": ["main"],
  "permissions": [
    "core:default",
    "opener:default",
    {
      "identifier": "shell:allow-execute",
      "allow": [
        {
          "name": "binaries/proxmark3",
          "sidecar": true,
          "args": [
            { "validator": "^-p$" },
            { "validator": "^(COM[1-9]\\d*|/dev/tty\\.(usbmodem|usbserial)[A-Za-z0-9]+|/dev/tty(ACM|USB)\\d{1,2})$" },
            { "validator": "^-f$" },
            { "validator": "^-c$" },
            { "validator": "^[a-zA-Z0-9 _.:\\-]{1,500}$" }
          ]
        },
        {
          "name": "proxmark3",
          "cmd": "proxmark3",
          "args": [
            { "validator": "^-p$" },
            { "validator": "^(COM[1-9]\\d*|/dev/tty\\.(usbmodem|usbserial)[A-Za-z0-9]+|/dev/tty(ACM|USB)\\d{1,2})$" },
            { "validator": "^-f$" },
            { "validator": "^-c$" },
            { "validator": "^[a-zA-Z0-9 _.:\\-]{1,500}$" }
          ]
        },
        {
          "name": "proxmark3-win-c",
          "cmd": "C:\\proxmark3\\proxmark3.exe",
          "args": [
            { "validator": "^-p$" },
            { "validator": "^(COM[1-9]\\d*|/dev/tty\\.(usbmodem|usbserial)[A-Za-z0-9]+|/dev/tty(ACM|USB)\\d{1,2})$" },
            { "validator": "^-f$" },
            { "validator": "^-c$" },
            { "validator": "^[a-zA-Z0-9 _.:\\-]{1,500}$" }
          ]
        },
        {
          "name": "proxmark3-win-progfiles",
          "cmd": "C:\\Program Files\\proxmark3\\proxmark3.exe",
          "args": [
            { "validator": "^-p$" },
            { "validator": "^(COM[1-9]\\d*|/dev/tty\\.(usbmodem|usbserial)[A-Za-z0-9]+|/dev/tty(ACM|USB)\\d{1,2})$" },
            { "validator": "^-f$" },
            { "validator": "^-c$" },
            { "validator": "^[a-zA-Z0-9 _.:\\-]{1,500}$" }
          ]
        },
        {
          "name": "proxmark3-mac-local",
          "cmd": "/usr/local/bin/proxmark3",
          "args": [
            { "validator": "^-p$" },
            { "validator": "^(COM[1-9]\\d*|/dev/tty\\.(usbmodem|usbserial)[A-Za-z0-9]+|/dev/tty(ACM|USB)\\d{1,2})$" },
            { "validator": "^-f$" },
            { "validator": "^-c$" },
            { "validator": "^[a-zA-Z0-9 _.:\\-]{1,500}$" }
          ]
        },
        {
          "name": "proxmark3-mac-brew",
          "cmd": "/opt/homebrew/bin/proxmark3",
          "args": [
            { "validator": "^-p$" },
            { "validator": "^(COM[1-9]\\d*|/dev/tty\\.(usbmodem|usbserial)[A-Za-z0-9]+|/dev/tty(ACM|USB)\\d{1,2})$" },
            { "validator": "^-f$" },
            { "validator": "^-c$" },
            { "validator": "^[a-zA-Z0-9 _.:\\-]{1,500}$" }
          ]
        },
        {
          "name": "proxmark3-linux-local",
          "cmd": "/usr/local/bin/proxmark3",
          "args": [
            { "validator": "^-p$" },
            { "validator": "^(COM[1-9]\\d*|/dev/tty\\.(usbmodem|usbserial)[A-Za-z0-9]+|/dev/tty(ACM|USB)\\d{1,2})$" },
            { "validator": "^-f$" },
            { "validator": "^-c$" },
            { "validator": "^[a-zA-Z0-9 _.:\\-]{1,500}$" }
          ]
        },
        {
          "name": "proxmark3-linux-usr",
          "cmd": "/usr/bin/proxmark3",
          "args": [
            { "validator": "^-p$" },
            { "validator": "^(COM[1-9]\\d*|/dev/tty\\.(usbmodem|usbserial)[A-Za-z0-9]+|/dev/tty(ACM|USB)\\d{1,2})$" },
            { "validator": "^-f$" },
            { "validator": "^-c$" },
            { "validator": "^[a-zA-Z0-9 _.:\\-]{1,500}$" }
          ]
        }
      ]
    }
  ]
}
